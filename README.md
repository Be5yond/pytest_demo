# åˆ©ç”¨pytestç‰¹æ€§ï¼Œå®ç°é«˜å¯ç”¨æ€§è‡ªåŠ¨åŒ–æµ‹è¯•

***

# æµ‹è¯•æ¡†æ¶éœ€è¦è§£å†³çš„é—®é¢˜
## 1.å¯ç»´æŠ¤æ€§
ğŸˆ _**æµ‹è¯•è‡ªåŠ¨åŒ–è„šæœ¬æ˜¯è½¯ä»¶å¼€å‘, éœ€è¦æŠ•å…¥åˆ°ç»´æŠ¤çš„ç²¾åŠ›çš„å¤šå°‘ï¼Œæ˜¯åŒºåˆ†å¥½çš„æµ‹è¯•ä»£ç ç»“æ„çš„å…³é”®å› ç´ **_ ğŸˆ
* æ•æ·å¼€å‘æ¨¡å¼ä¸‹çš„ç³»ç»Ÿï¼Œè‡ªåŠ¨åŒ–ä»£ç å¦‚ä½•åº”å¯¹ç³»ç»Ÿé¢‘ç¹çš„å˜åŠ¨ï¼Ÿ   
* å¤§é‡çš„æµ‹è¯•æ•°æ®å¦‚ä½•ç®¡ç†ï¼Œå¦‚ä½•æ›´æ–°ï¼Ÿ
* æµ‹è¯•ç¯å¢ƒå†™å®Œçš„caseå¦‚ä½•åœ¨å…¶ä»–ç¯å¢ƒæ‰§è¡Œï¼Ÿ
## 2.æ˜“ç”¨æ€§
ğŸˆ _**ä»£ç é¦–å…ˆæ˜¯å†™ç»™äººçœ‹çš„ï¼Œå…¶æ¬¡æ‰æ˜¯è®¡ç®—æœºé¡ºä¾¿èƒ½å¤Ÿè¿è¡Œ**_ ğŸˆ
* å¦‚ä½•æé«˜è‡ªåŠ¨åŒ–caseçš„ç¼–å†™æ•ˆç‡ï¼Ÿ
* å¦‚ä½•å†™å¯è¯»æ€§é«˜çš„è‡ªåŠ¨åŒ–caseï¼Œè¾¾åˆ°ä»£ç å³æ˜¯ç”¨ä¾‹çš„æ•ˆæœï¼Ÿ
* å¦‚ä½•å‡å°‘ç¼–ç é‡ï¼Œé™ä½è‡ªåŠ¨åŒ–caseç¼–ç äººå‘˜çš„æŠ€æœ¯èƒ½åŠ›è¦æ±‚ï¼Ÿ   
### ä»¥ä¸‹æ‰€æœ‰çš„è®¾è®¡éƒ½æ˜¯å›´ç»•è¿™ä¸¤ç‚¹å±•å¼€ï¼Œä»ä»£ç ç»„ç»‡å’Œæ•°æ®ç®¡ç†ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹ã€‚[ç¤ºä¾‹demo](https://github.com/Be5yond/pytest_demo/wiki/1.%E4%BB%A3%E7%A0%81%E5%8D%B3%E7%94%A8%E4%BE%8B%EF%BC%88case%E7%9A%84%E5%8F%AF%E8%AF%BB%E6%80%A7%E5%92%8C%E6%98%93%E7%94%A8%E6%80%A7%EF%BC%89)


# æ ¸å¿ƒç‰¹æ€§
* å…³é”®å­—é©±åŠ¨ï¼šè¿™æ ·å¥½å¤„æ˜¯å¯å¤ç”¨æ€§ï¼Œæµ‹è¯•ç¨‹å¼å·²åœ¨é«˜åº¦æŠ½è±¡åŒ–çš„å±‚çº§ä¸‹åˆ›å»ºï¼Œå‡å°‘ç»´æŠ¤çš„æˆæœ¬ã€‚è¿˜å¯ä»¥æé«˜å¯è¯»æ€§å’Œå¼€å‘æ•ˆç‡ã€‚
* æµ‹è¯•æ•°æ®ä¸æµ‹è¯•ä»£ç åˆ†ç¦»ï¼šæ–¹ä¾¿æ•°æ®çš„ç®¡ç†ä¸ç»´æŠ¤ï¼Œè§£å†³æµ‹è¯•æ•°æ®ä¸­å˜é‡çš„æ”¯æŒã€‚
* æµ‹è¯•æ•°æ®åŠ¨æ€åŠ è½½ï¼šä¸åŒç¯å¢ƒçš„é…ç½®å˜é‡ï¼Œå’Œè¯·æ±‚ä¹‹é—´çš„ä¸Šä¸‹æ–‡æ•°æ®ä¾èµ–åŠ¨æ€åŠ è½½ã€‚
* å¤šç¯å¢ƒæ”¯æŒï¼šé…ç½®åŒ–ï¼ŒåŒä¸€å¥—æµ‹è¯•ä»£ç å¯åœ¨ä¸åŒç¯å¢ƒæ‰§è¡Œï¼ˆå¼€å‘ï¼Œæµ‹è¯•ï¼Œé¢„å‘å¸ƒï¼‰ï¼Œæ— éœ€é¢å¤–ä¿®æ”¹ã€‚
* æŠ¥å‘Šä¸æ—¥å¿—ï¼šé›†æˆç¾è§‚çš„æµ‹è¯•æŠ¥å‘Šæ¡†æ¶ï¼Œè®°å½•ä¸°å¯Œçš„æ‰§è¡Œä¿¡æ¯ï¼Œä»æ‰§è¡Œæ—¥å¿—ä¸­åˆ†æå®šä½é—®é¢˜ç¨‹åºã€‚



# ä»£ç æ¡†æ¶è®¾è®¡
åˆç†çš„å°è£…å‡½æ•°è®¾è®¡ï¼Œå°†ä½¿å¾—è‡ªåŠ¨åŒ–è„šæœ¬ç®€æ´åŒ–ã€ä¸€è‡´æ€§ï¼Œå¯ç»´æŠ¤æ€§é«˜ã€‚è¿›è¡Œé€»è¾‘ä¸Šçš„åˆ†å±‚ï¼Œå‡å°‘é‡å¤ä»£ç ï¼Œç³»ç»Ÿå˜åŒ–å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•ç¨‹åºçš„å½±å“æ§åˆ¶åœ¨ç‰¹å®šæ¨¡å—ï¼Œå¯ä»¥å¿«é€Ÿä¿®æ”¹ç»´æŠ¤ã€‚   
### æ¨¡å—çš„ç»„ç»‡
![æ¨¡å—åˆ†å±‚å›¾ç‰‡](https://github.com/Be5yond/pytest_demo/blob/master/datas/screenshot_layer.png?raw=true)
### æ¯ä¸€å±‚çš„åŠŸèƒ½å¦‚ä¸‹
### 1. ç”¨ä¾‹åœºæ™¯å±‚
> å°†æ¨¡å—å±‚å’Œæ¥å£å±‚çš„å…³é”®å­—ï¼Œç»„åˆæˆä¸šåŠ¡æµç¨‹ï¼Œå®Œæˆç”¨ä¾‹åœºæ™¯çš„æ„å»ºå’Œæµ‹è¯•ã€‚
### 2. æ¨¡å—å±‚
> æŒ‰ä¸šåŠ¡æ¨¡å—å°è£…ä¸ºå¯å¤ç”¨å…³é”®å­—,ä¾›æµ‹è¯•åœºæ™¯ä½¿ç”¨
> ç»„åˆå¤šä¸ªapiæ„é€ ç‰¹å®šä¸šåŠ¡åŠ¨ä½œ   
> > ä¾‹å¦‚ï¼š1è°ƒç”¨å•†å“åˆ—è¡¨æ¥å£+é€‰å–ä¸¤ä¸ªå•†å“idè°ƒç”¨æ·»åŠ è´­ç‰©è½¦æ¥å£+æäº¤è®¢å•æ¥å£ï¼Œä¸²æˆä¸€ä¸ªå·¥ä½œæµï¼Œç»„åˆæˆå…³é”®å­—**ç”Ÿæˆä¸€ä¸ªæ–°è®¢å•**ã€‚   
> >      2ç³»ç»ŸAæäº¤å®¡æ ¸ä¿¡æ¯æ¥å£+å®¡æ ¸ç³»ç»Ÿå®¡æ ¸é€šè¿‡ï¼Œä¸²æˆä¸€ä¸ªå·¥ä½œæµç»„æˆå…³é”®å­—**ç”Ÿæˆä¸€ä¸ªå®¡æ ¸é€šè¿‡çš„æ•°æ®**ã€‚
### 3. æ¥å£å±‚
> ä¸è¢«æµ‹ç³»ç»Ÿçš„ä¸€æ¬¡äº¤äº’ï¼Œå¯ä»¥æ˜¯å‘é€ä¸€ä¸ªhttpè¯·æ±‚ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸­å‘é€ä¸€æ¡æ•°æ®ï¼Œæˆ–è€…ä¿®æ”¹æ•°æ®åº“ä¸­æŸä¸ªå­—æ®µ   
> åŠŸèƒ½ï¼šæ“ä½œä¸­çš„é€šç”¨ä¿¡æ¯å®ç°åœ¨æ­¤å±‚   
> > ä¾‹å¦‚ï¼šHTTPè¯·æ±‚éœ€è¦æ·»åŠ é€šç”¨å­—æ®µ å¯¹å‚æ•°è¿›è¡Œæ’åºåmd5åŠ å¯†ï¼Œå‚æ•°ä¸­è¦ä¼ æ—¶é—´æˆ³..
>> å˜é‡çš„æ›¿æ¢
### 4. ä¼šè¯å±‚
> ç®¡ç†ä¸ç³»ç»Ÿè¿æ¥ï¼ŒåŒ…æ‹¬http, kafka, Database, Redis...   
> åŠŸèƒ½ï¼šå¦‚æ‰“å°logï¼Œå¤šç¯å¢ƒé…ç½®ä¿¡æ¯ï¼Œé€šç”¨åŠŸèƒ½çš„å®ç°å¦‚ï¼ˆå‚æ•°çš„åŠ¨æ€æ¸²æŸ“èƒ½åŠ›ï¼‰ã€‚

## è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„

![æ¨¡å—ç»†èŠ‚å›¾ç‰‡](https://github.com/Be5yond/pytest_demo/blob/master/datas/screenshot_module.png?raw=true)
é€šè¿‡é€»è¾‘ä¸Šçš„åˆ†å±‚ï¼Œä½¿å¾—testcaseæ˜¯ç”±moduleå’Œapiçš„è°ƒç”¨ç»„æˆï¼Œå¢åŠ äº†ä»£ç çš„å¤ç”¨ï¼Œç³»ç»Ÿå‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¹æµ‹è¯•ä»£ç çš„å½±å“ä¹Ÿè¢«é™ä½ï¼Œå¦‚å›¾API_1çš„æ¥å£å‚æ•°å‘ç”Ÿå˜åŒ–æˆ–è€…API_3çš„å®ç°æ–¹å¼å‘ç”Ÿä¿®æ”¹ï¼Œåªéœ€è¦ä¿®æ”¹å¯¹åº”çš„æ•°æ®å³å¯ï¼Œtestcaseå±‚ä¸éœ€è¦ä¿®æ”¹ã€‚

è€Œä¸”ï¼Œé€šè¿‡åˆ†å±‚ä¹‹åï¼Œå¯ä»¥å°†apiå…¬å…±å‚æ•°æ”¾åˆ°ä¸åŒçš„å±‚çº§æ¥å®ç°ï¼Œå°±åƒTCP/IPç½‘ç»œçš„å°è£…æ•°æ®ä¸€æ ·ï¼Œå®ç°ä¸åŒçº§åˆ«çš„é»˜è®¤æ•°æ®çš„æ·»åŠ ã€‚å‡å°‘testdataçš„ç»´æŠ¤ï¼Œä½¿å¾—æµ‹è¯•æ•°æ®ä¸­åªæœ‰æ§åˆ¶ä¸šåŠ¡ç›¸å…³çš„å­—æ®µã€‚   
![æµ‹è¯•æ•°æ®å‡å°‘](https://github.com/Be5yond/pytest_demo/blob/master/datas/screenshot_data.png?raw=true)

## example
[åˆ†å±‚æ¨¡å—åŒ–ç»„ç»‡è‡ªåŠ¨åŒ–æµ‹è¯•çš„å®è·µdemo](https://github.com/Be5yond/pytest_demo/wiki/1.%E4%BB%A3%E7%A0%81%E5%8D%B3%E7%94%A8%E4%BE%8B%EF%BC%88case%E7%9A%84%E5%8F%AF%E8%AF%BB%E6%80%A7%E5%92%8C%E6%98%93%E7%94%A8%E6%80%A7%EF%BC%89)

# å¿«é€Ÿå¼€å§‹
- cloneæœ¬é¡¹ç›®
- Dependency  
   + python3  
   + pip install -r requirements.txt
   + jenkins (*)
   + allure(*)
   + mongodb(*)
- è¿è¡Œ
   + docker run --name mongo -d -v /root/docker/mongo:/data/db -p 27017:27017 mongo
   + pytest
   + allure serve -p 8090

